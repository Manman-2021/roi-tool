<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è¾¾äººROIä¸æ”¶å…¥ç²¾ç®—å™¨</title>
    
    <link rel="icon" type="image/png" href="icon.png">
    <link rel="apple-touch-icon" href="icon.png">

    <style>
        /* å…¨å±€æ ·å¼ */
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Microsoft YaHei', sans-serif;
            background-color: #f0f2f5;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            min-height: 100vh;
            color: #333;
        }
        .app-container {
            width: 100%;
            max-width: 400px;
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            overflow: hidden;
            height: fit-content;
        }
        header {
            background: #fe2c55;
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: bold;
            font-size: 16px;
        }
        .content { padding: 15px; }
        .section {
            background: white;
            margin-bottom: 20px;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #eee;
            box-shadow: 0 2px 8px rgba(0,0,0,0.02);
        }
        h3 {
            margin: 0 0 15px 0;
            font-size: 15px;
            border-left: 4px solid #fe2c55;
            padding-left: 10px;
            display: flex;
            justify-content: space-between;
        }
        .badge {
            background: #e8f5e9;
            color: #2e7d32;
            font-size: 11px;
            padding: 3px 8px;
            border-radius: 10px;
            font-weight: normal;
        }
        .row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        .row label { font-size: 14px; color: #555; flex: 1; }
        .row input {
            width: 90px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 6px;
            text-align: right;
            font-size: 15px;
            outline: none;
            background: #fafafa;
        }
        .row input:focus {
            border-color: #fe2c55;
            background: #fff;
        }
        .unit { font-size: 13px; color: #999; margin-left: 8px; width: 15px; }
        .cost-input { border-color: #ffcccc !important; color: #d32f2f; background-color: #fffafa !important; }
        .result-box {
            background: #f8f9fa;
            border: 1px dashed #ddd;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            text-align: center;
        }
        .result-value {
            font-size: 26px;
            font-weight: 800;
            color: #fe2c55;
        }
        .sub-result { font-size: 12px; color: #999; margin-top: 5px; }
        hr { border: 0; border-top: 1px solid #eee; margin: 10px 0 15px 0; }
        footer { text-align: center; font-size: 12px; color: #bbb; margin-top: 20px; padding-bottom: 10px; }
    </style>
</head>
<body>

    <div class="app-container">
        <header>ğŸ“Š è¾¾äººä½£é‡‘ç²¾ç®—å™¨ Webç‰ˆ</header>

        <div class="content">
            <div class="section">
                <h3>ğŸ” å•å“æŠ•æµæµ‹ç®— <span class="badge">æ¿å—ä¸€</span></h3>
                <div class="row"><label>1. å•†å“ä»·æ ¼</label><input type="number" id="p1_price" placeholder=""><span class="unit">å…ƒ</span></div>
                <div class="row"><label>2. ä½£é‡‘ç‡</label><input type="number" id="p1_rate" placeholder=""><span class="unit">%</span></div>
                <hr>
                <div class="row"><label>3. å‘è´§å‰é€€æ¬¾ç‡</label><input type="number" id="p1_refund_pre" placeholder=""><span class="unit">%</span></div>
                <div class="row"><label>4. å‘è´§åé€€è´§ç‡</label><input type="number" id="p1_refund_post" placeholder=""><span class="unit">%</span></div>
                <div class="row"><label>5. ä½£é‡‘æç°è´¹ç‡</label><input type="number" id="p1_tax" placeholder=""><span class="unit">%</span></div>

                <div class="result-box">
                    <div class="result-title">æŠ•æµä¿æœ¬ ROI (ç›ˆäºçº¿)</div>
                    <div class="result-value" id="res_roi">0.00</div>
                    <div class="sub-result">æ¯å–ä¸€å•å‡€èµšä½£é‡‘: <span id="res_profit_per_order">Â¥0.00</span></div>
                </div>
            </div>

            <div class="section">
                <h3>ğŸ’° å•åœºå‡€åˆ©æ¶¦å¤ç›˜ <span class="badge">æ¿å—äºŒ</span></h3>

                <div class="row"><label>1. æœ¬åœºç›´æ’­ GMV</label><input type="number" id="p2_gmv" placeholder=""><span class="unit">å…ƒ</span></div>
                <div class="row"><label>2. æ€»é€€æ¬¾/é€€è´§ç‡</label><input type="number" id="p2_refund_total" placeholder="è‡ªåŠ¨" disabled style="background:#eee;"><span class="unit">%</span></div>
                
                <div class="row"><label>â†³ å‘è´§å‰é€€æ¬¾ç‡</label><input type="number" id="p2_refund_pre" placeholder=""><span class="unit">%</span></div>
                <div class="row"><label>â†³ å‘è´§åé€€è´§ç‡</label><input type="number" id="p2_refund_post" placeholder=""><span class="unit">%</span></div>
                <hr>
                <div class="row"><label>4. è®¡ä½£é‡‘é¢ä½£é‡‘ç‡</label><input type="number" id="p2_rate" placeholder=""><span class="unit">%</span></div>
                <div class="row"><label>5. æç°è´¹ç‡</label><input type="number" id="p2_tax" placeholder=""><span class="unit">%</span></div>
                <div class="row"><label style="color:#d32f2f; font-weight:bold;">6. æœ¬åœºæŠ•æµè´¹ç”¨</label><input type="number" id="p2_ad_cost" placeholder="" class="cost-input"><span class="unit">å…ƒ</span></div>

                <div class="result-box" style="border-color: #00b85c; background: #f0f9f4;">
                    <div class="result-title">å»é™¤æŠ•æµåÂ·å‡€åˆ©æ¶¦</div>
                    <div class="result-value" id="res_income" style="color: #00b85c;">Â¥0.00</div>
                    <div class="sub-result">çº¯ä½£é‡‘æ”¶å…¥: <span id="res_gross_income">Â¥0</span></div>
                </div>
            </div>

            <footer>çº¯å‡€æ¨¡å¼ Â· æ— å†å²è®°å½•</footer>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const inputs = document.querySelectorAll('input');
            
            // ç®€å•ç»‘å®šï¼šè¾“å…¥å³è®¡ç®—ï¼Œä¸ä¿å­˜ï¼Œä¸è¯»å–
            inputs.forEach(input => {
                input.addEventListener('input', calculateAll);
            });

            calculateAll();
        });

        function calculateAll() {
            calculateSection1();
            calculateSection2();
        }

        function calculateSection1() {
            const price = parseFloat(document.getElementById('p1_price').value) || 0;
            const rate = parseFloat(document.getElementById('p1_rate').value) || 0;
            const refundPre = parseFloat(document.getElementById('p1_refund_pre').value) || 0;
            const refundPost = parseFloat(document.getElementById('p1_refund_post').value) || 0;
            const tax = parseFloat(document.getElementById('p1_tax').value) || 0;

            const validPercent = (1 - (refundPre/100) - (refundPost/100));
            const taxPercent = (1 - (tax/100));
            const commissionPercent = (rate/100);
            const finalRatio = validPercent * commissionPercent * taxPercent;

            let roi = 0;
            if (finalRatio > 0) { roi = 1 / finalRatio; }
            const profitPerOrder = price * finalRatio;

            const roiEl = document.getElementById('res_roi');
            if (roi > 0 && roi < 100) { roiEl.innerText = roi.toFixed(2); }
            else if (roi >= 100) { roiEl.innerText = "99.9+"; }
            else { roiEl.innerText = "0.00"; }
            document.getElementById('res_profit_per_order').innerText = 'Â¥' + profitPerOrder.toFixed(2);
        }

        function calculateSection2() {
            const gmv = parseFloat(document.getElementById('p2_gmv').value) || 0;
            const refundPre = parseFloat(document.getElementById('p2_refund_pre').value) || 0;
            const refundPost = parseFloat(document.getElementById('p2_refund_post').value) || 0;
            const rate = parseFloat(document.getElementById('p2_rate').value) || 0;
            const tax = parseFloat(document.getElementById('p2_tax').value) || 0;
            const adCost = parseFloat(document.getElementById('p2_ad_cost').value) || 0;

            document.getElementById('p2_refund_total').value = (refundPre + refundPost).toFixed(1);

            const validPercent = (1 - (refundPre/100) - (refundPost/100));
            const realGmv = gmv * validPercent; 
            const commissionPercent = (rate/100);
            const taxPercent = (1 - (tax/100));
            const grossIncome = realGmv * commissionPercent * taxPercent;
            const netProfit = grossIncome - adCost;

            const incomeEl = document.getElementById('res_income');
            incomeEl.innerText = 'Â¥' + netProfit.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2});
            document.getElementById('res_gross_income').innerText = 'Â¥' + grossIncome.toLocaleString('en-US', {maximumFractionDigits: 0});

            if (netProfit < 0) { incomeEl.style.color = '#d32f2f'; }
            else { incomeEl.style.color = '#00b85c'; }
        }
    </script>
</body>
</html>
